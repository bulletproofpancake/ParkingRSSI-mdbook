<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>ParkingRSSI Documentation</title>
        <meta name="robots" content="noindex" />
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="chapters/index.html">Introduction</a></li><li class="chapter-item expanded affix "><li class="part-title">Activity</li><li class="chapter-item expanded "><a href="chapters/ch1/mainActivity.html"><strong aria-hidden="true">1.</strong> MainActivity</a></li><li class="chapter-item expanded affix "><li class="part-title">Classes</li><li class="chapter-item expanded "><a href="chapters/db/dbHelper.html"><strong aria-hidden="true">2.</strong> DBHelper</a></li><li class="chapter-item expanded "><a href="chapters/knn/knnClassifier.html"><strong aria-hidden="true">3.</strong> KNNClassifier</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">4.</strong> RecyclerViewAdapter</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">5.</strong> Router</div></li><li class="chapter-item expanded affix "><li class="part-title">Fragments</li><li class="chapter-item expanded "><div><strong aria-hidden="true">6.</strong> DataFragment</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">7.</strong> HomeFragment</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">8.</strong> ScanRouterFragment</div></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">ParkingRSSI Documentation</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="parking-rssi"><a class="header" href="#parking-rssi">Parking RSSI</a></h1>
<p>A smart parking system that uses RSSI to detect available parking slots.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="main-activity"><a class="header" href="#main-activity">Main Activity</a></h1>
<ul>
<li>Controls the navigation of the app.</li>
</ul>
<h2 id="code-analysis"><a class="header" href="#code-analysis">Code Analysis</a></h2>
<h3 id="mainactivitykt"><a class="header" href="#mainactivitykt">MainActivity.kt</a></h3>
<pre><code class="language-kt">class MainActivity : AppCompatActivity() {

    private lateinit var binding: ActivityMainBinding

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)

        binding = ActivityMainBinding.inflate(layoutInflater)
        setContentView(binding.root)

        val navView: BottomNavigationView = binding.navView

        val navController = findNavController(R.id.nav_host_fragment_activity_main)
        // Passing each menu ID as a set of Ids because each
        // menu should be considered as top level destinations.
        val appBarConfiguration = AppBarConfiguration(
            setOf(
                R.id.navigation_home, R.id.navigation_scan_routers, R.id.navigation_notifications
            )
        )
        setupActionBarWithNavController(navController, appBarConfiguration)
        navView.setupWithNavController(navController)
    }
}
</code></pre>
<div class="table-wrapper"><table><thead><tr><th>Snippet</th><th>Description</th></tr></thead><tbody>
<tr><td><code>class MainActivity : AppCompatActivity()</code></td><td>Declares a class named <code>MainActivity</code> that inherits from <a href="https://developer.android.com/reference/androidx/appcompat/app/AppCompatActivity"><code>AppCompatActivity</code></a>.</td></tr>
<tr><td><code>private lateinit var binding : ActivityMainBinding</code></td><td>Declares a variable named <code>binding</code> of which is used to <a href="https://developer.android.com/topic/libraries/data-binding/expressions#binding_data">bind the code to the <code>activity_main.xml</code> layout</a>.</td></tr>
<tr><td><code>override fun onCreate(savedInstanceState:Bundle?)</code></td><td><a href="https://kotlinlang.org/docs/inheritance.html">Overrides</a> the <code>onCreate</code> function from <a href="https://developer.android.com/reference/android/app/Activity#onCreate(android.os.Bundle)"><code>Activity</code></a> <em>(the class which <code>AppCompatActivity</code> inherits from)</em>.</td></tr>
<tr><td><code>super.onCreate(savedInstanceState)</code></td><td>Executes the <code>onCreate</code> function as it is implemented by the classes <code>MainActivity</code> inherits from.</td></tr>
<tr><td><code>binding = ActivityMainBinding.inflate(layoutInflated)</code></td><td><a href="https://stackoverflow.com/questions/4576330/what-does-it-mean-to-inflate-a-view-from-an-xml-file">Makes the contents of the xml file bound to <code>ActivityMainBinding</code> accessible.</a></td></tr>
<tr><td><code>setContentView(binding.root)</code></td><td><a href="https://developer.android.com/reference/android/app/Activity#setContentView(android.view.View)">Sets the content view</a> on the <a href="https://developer.android.com/reference/android/databinding/ViewDataBinding#getroot"><code>root</code></a> of the view.</td></tr>
<tr><td><code>val navView: BottomNavigationView = binding.navView</code></td><td>Declares a variable named <code>navView</code> which is of type <a href="https://developer.android.com/reference/com/google/android/material/bottomnavigation/BottomNavigationView"><code>BottomNavigationView</code></a> from the <code>navView</code> property of <code>binding</code></td></tr>
<tr><td><code>val navController = findNavController(R.id.nav_host_fragment_activity_main)</code></td><td>Declares a variable named <code>navController</code> and sets it to the <code>navHostFragment</code> from <code>activity_main.xml</code>.</td></tr>
<tr><td><code>val appBarConfiguration = AppBarConfiguration(setOf(R.id.navigation_home, R.id.navigation_scan_routers, R.id.navigation_notifications)</code></td><td><a href="https://developer.android.com/reference/androidx/navigation/ui/AppBarConfiguration">Creates a configuration for the application bar.</a></td></tr>
<tr><td><code>setupActionBarWithNavController(navController, appBarConfiguration)</code></td><td><a href="https://developer.android.com/reference/androidx/navigation/ui/NavigationUI#setupActionBarWithNavController(androidx.appcompat.app.AppCompatActivity,androidx.navigation.NavController,androidx.navigation.ui.AppBarConfiguration)">Sets up the action bar to the <code>navController</code>.</a></td></tr>
<tr><td><code>navView.setupWithNavController(navController)</code></td><td><a href="https://developer.android.com/reference/androidx/navigation/ui/NavigationUI#setupWithNavController(com.google.android.material.navigation.NavigationBarView,androidx.navigation.NavController)">Sets up the navigation view according to the <code>navController</code>.</a></td></tr>
</tbody></table>
</div>
<p>In order for this code to make sense, we must also see how it looks in the context of the app, so we would also need to understand the <code>activity_main.xml</code> and <code>mobile_navigation.xml</code> files.</p>
<h3 id="understanding-the-layout"><a class="header" href="#understanding-the-layout">Understanding the layout</a></h3>
<h4 id="activity_main"><a class="header" href="#activity_main">activity_main</a></h4>
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;androidx.constraintlayout.widget.ConstraintLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;
    android:id=&quot;@+id/container&quot;
    android:layout_width=&quot;match_parent&quot;
    android:layout_height=&quot;match_parent&quot;&gt;

    &lt;com.google.android.material.bottomnavigation.BottomNavigationView
        android:id=&quot;@+id/nav_view&quot;
        android:layout_width=&quot;0dp&quot;
        android:layout_height=&quot;56dp&quot;
        android:layout_marginStart=&quot;0dp&quot;
        android:layout_marginEnd=&quot;0dp&quot;
        android:background=&quot;?android:attr/windowBackground&quot;
        app:layout_constraintBottom_toBottomOf=&quot;parent&quot;
        app:layout_constraintLeft_toLeftOf=&quot;parent&quot;
        app:layout_constraintRight_toRightOf=&quot;parent&quot;
        app:menu=&quot;@menu/bottom_nav_menu&quot; /&gt;

    &lt;fragment
        android:id=&quot;@+id/nav_host_fragment_activity_main&quot;
        android:name=&quot;androidx.navigation.fragment.NavHostFragment&quot;
        android:layout_width=&quot;match_parent&quot;
        android:layout_height=&quot;match_parent&quot;
        android:layout_marginBottom=&quot;56dp&quot;
        app:defaultNavHost=&quot;true&quot;
        app:layout_constraintBottom_toTopOf=&quot;@+id/nav_view&quot;
        app:layout_constraintLeft_toLeftOf=&quot;parent&quot;
        app:layout_constraintRight_toRightOf=&quot;parent&quot;
        app:layout_constraintTop_toTopOf=&quot;parent&quot;
        app:navGraph=&quot;@navigation/mobile_navigation&quot; /&gt;

&lt;/androidx.constraintlayout.widget.ConstraintLayout&gt;
</code></pre>
<p>Output:
<img src="https://i.imgur.com/ulc91yD.png" alt="" /></p>
<p>Once we open up <code>activity_main.xml</code> we can see the app, and more importantly, its layout. If we look at the layout, we can see that at the bottom portion of our screen, we have a bar that is named <code>nav_view</code> which hosts the different buttons we need to navigate our app and the rest of the screen is taken up by the <code>nav_host_fragment_activity_main</code>, which would display the different screens of the app.</p>
<p>In our <code>MainActivity.kt</code> file, we assign these properties to variables that we can access in code. The <code>nav_view</code> property is set to the <code>navView</code> variable, and the <code>nav_host_fragment_activity_main</code> is set to the <code>navController</code> variable.</p>
<pre><code class="language-kt">        val navView: BottomNavigationView = binding.navView

        val navController = findNavController(R.id.nav_host_fragment_activity_main)
</code></pre>
<p>To control the fragments shown on the screen, we need to create an <code>appBarConfiguration</code> which determines the elements for the <code>navView</code>, and for this we would need the <code>mobile_navigation.xml</code>.</p>
<h4 id="mobile_navigation"><a class="header" href="#mobile_navigation">mobile_navigation</a></h4>
<p>Source:</p>
<pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;navigation xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;
    xmlns:tools=&quot;http://schemas.android.com/tools&quot;
    android:id=&quot;@+id/mobile_navigation&quot;
    app:startDestination=&quot;@+id/navigation_home&quot;&gt;

    &lt;fragment
        android:id=&quot;@+id/navigation_home&quot;
        android:name=&quot;com.silentrald.parkingrssi.ui.HomeFragment&quot;
        android:label=&quot;@string/title_home&quot;
        tools:layout=&quot;@layout/fragment_home&quot; /&gt;

    &lt;fragment
        android:id=&quot;@+id/navigation_scan_routers&quot;
        android:name=&quot;com.silentrald.parkingrssi.ui.ScanRouterFragment&quot;
        android:label=&quot;@string/scan_routers&quot;
        tools:layout=&quot;@layout/fragment_scan_router&quot; /&gt;

    &lt;fragment
        android:id=&quot;@+id/navigation_notifications&quot;
        android:name=&quot;com.silentrald.parkingrssi.ui.DataFragment&quot;
        android:label=&quot;@string/data&quot;
        tools:layout=&quot;@layout/fragment_data&quot; /&gt;
&lt;/navigation&gt;
</code></pre>
<p>Output:
<img src="https://i.imgur.com/QJqS5iv.png" alt="" /></p>
<p>If we open up <code>mobile_navigation.xml</code>, we can see the different screens of our app, and when we look at the code side of things we can see that the ids of each fragment correspond to the parameters which have been set in the <code>appBarConfiguration</code>.</p>
<pre><code class="language-xml">    &lt;fragment
        android:id=&quot;@+id/navigation_home&quot;
        android:name=&quot;com.silentrald.parkingrssi.ui.HomeFragment&quot;
        android:label=&quot;@string/title_home&quot;
        tools:layout=&quot;@layout/fragment_home&quot; /&gt;
</code></pre>
<pre><code class="language-xml">    &lt;fragment
        android:id=&quot;@+id/navigation_scan_routers&quot;
        android:name=&quot;com.silentrald.parkingrssi.ui.ScanRouterFragment&quot;
        android:label=&quot;@string/scan_routers&quot;
        tools:layout=&quot;@layout/fragment_scan_router&quot; /&gt;
</code></pre>
<pre><code class="language-xml">    &lt;fragment
        android:id=&quot;@+id/navigation_notifications&quot;
        android:name=&quot;com.silentrald.parkingrssi.ui.DataFragment&quot;
        android:label=&quot;@string/data&quot;
        tools:layout=&quot;@layout/fragment_data&quot; /&gt;
</code></pre>
<pre><code class="language-kt">        // Passing each menu ID as a set of Ids because each
        // menu should be considered as top level destinations.
        val appBarConfiguration = AppBarConfiguration(
            setOf(
                R.id.navigation_home, R.id.navigation_scan_routers, R.id.navigation_notifications
            )
</code></pre>
<p>Once the <code>appBarConfiguration</code> has been made, we would now apply it to the <code>navController</code> so that when we select an option from the <code>nav_view</code> portion of our screen, it would reflect on the <code>nav_host_fragment_activity_main</code> portion as well.</p>
<pre><code class="language-kt">        setupActionBarWithNavController(navController, appBarConfiguration)
        navView.setupWithNavController(navController)
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="db-helper"><a class="header" href="#db-helper">DB Helper</a></h1>
<ul>
<li>Saves the data of the app to an <a href="https://simple.wikipedia.org/wiki/Structured_Query_Language">SQL Database</a>.</li>
</ul>
<h1 id="code-analysis-1"><a class="header" href="#code-analysis-1">Code Analysis</a></h1>
<pre><code class="language-kt">class DBHelper(context: Context, factory: SQLiteDatabase.CursorFactory?) :
    SQLiteOpenHelper(context, DATABASE_NAME, factory, DATABASE_VERSION) {

    override fun onCreate(db: SQLiteDatabase) {
        db.execSQL(&quot;&quot;&quot;
            CREATE TABLE $ROUTER_TABLE (
                $ROUTER_BSSID   INTEGER PRIMARY KEY,
                $ROUTER_NAME    VARCHAR(32) NOT NULL,
                $ROUTER_ACTIVE  BOOLEAN NOT NULL DEFAULT 1,
                $ROUTER_ROW     INTEGER NOT NULL,
                $ROUTER_COL     INTEGER NOT NULL
            );
        &quot;&quot;&quot;.trimIndent())

        db.execSQL(&quot;&quot;&quot;
            CREATE TABLE $DATA_TABLE (
                $DATA_ID       INTEGER PRIMARY KEY,
                $DATA_INPUT    INTEGER NOT NULL,
                $DATA_LEVELS   TEXT NOT NULL,
                $DATA_LABELS   TEXT NOT NULL
            );
        &quot;&quot;&quot;.trimIndent())

        db.execSQL(&quot;&quot;&quot;
            INSERT INTO $DATA_TABLE (
                $DATA_ID,
                $DATA_INPUT,
                $DATA_LEVELS,
                $DATA_LABELS
            )
            VALUES (0, 0, '', '');
        &quot;&quot;&quot;.trimIndent())
    }

    override fun onUpgrade(db: SQLiteDatabase?, oldVersion: Int, newVersion: Int) {
        db!!.execSQL(&quot;DROP TABLE IF EXISTS $DATA_TABLE&quot;)
        db.execSQL(&quot;&quot;&quot;DROP TABLE IF EXISTS $ROUTER_TABLE&quot;&quot;&quot;)
        onCreate(db)
    }

    fun addRouter(bssidStr: String, name: String, row: Int, col: Int, active: Boolean = true) {
        val bssid = Router.convertBSSIDToLong(bssidStr)
        addRouter(bssid, name, row, col, active)
    }

    fun addRouter(bssid: Long, name: String, row: Int, col: Int, active: Boolean = true) {
        val values = ContentValues()
        values.put(ROUTER_BSSID, bssid)
        values.put(ROUTER_NAME, name)
        values.put(ROUTER_ACTIVE, active)
        values.put(ROUTER_ROW, row)
        values.put(ROUTER_COL, col)

        val db = this.writableDatabase
        db.insert(ROUTER_TABLE, null, values)
        db.close()
    }

    fun getRouters(): Cursor? {
        val db = this.readableDatabase
        return db.rawQuery(&quot;&quot;&quot;
            SELECT  *
            FROM    $ROUTER_TABLE;
        &quot;&quot;&quot;.trimIndent(), null)
    }

//    fun removeRouter(bssidStr: String) {
//        val bssid = Router.convertBSSIDToLong(bssidStr)
//        removeRouter(bssid)
//    }

//    fun removeRouter(bssid: Long) {
//        val db = this.writableDatabase
//        db.delete(ROUTER_TABLE, &quot;$ROUTER_BSSID=?&quot;, arrayOf(bssid.toString()))
//        db.close()
//    }

    fun removeAllRouters() {
        val db = this.writableDatabase
        db.delete(ROUTER_TABLE, &quot;&quot;, null)
        db.close()
    }

    fun getData(): Data {
        val db = this.readableDatabase
        val cursor = db.rawQuery(
            &quot;&quot;&quot;
            SELECT  *
            FROM    $DATA_TABLE
            WHERE   $DATA_ID = 0
            LIMIT   1;
        &quot;&quot;&quot;.trimIndent(), null
        )

        cursor.moveToFirst()
        val matrixString = cursor.getString(cursor.getColumnIndex(DATA_LEVELS))
        val labelsString = cursor.getString(cursor.getColumnIndex(DATA_LABELS))
        val input = cursor.getInt(cursor.getColumnIndex(DATA_INPUT))
        cursor.close()

        val matrix = arrayListOf&lt;ArrayList&lt;Float&gt;&gt;()
        if (!matrixString.equals(&quot;&quot;)) {
            val array = matrixString.split(&quot;\n&quot;)
            for (str in array) {
                val floatString = str.split(&quot;,&quot;)
                val floats = arrayListOf&lt;Float&gt;()
                for (fs in floatString) {
                    floats.add(fs.toFloat())
                }
                matrix.add(floats)
            }
        }

        val outputs = arrayListOf&lt;Int&gt;()
        if (!labelsString.equals(&quot;&quot;)) {
            val labels = labelsString.split(&quot;,&quot;)
            for (l in labels) {
                outputs.add(l.toInt())
            }
        }

        return Data(matrix, outputs, input)
    }

    fun setData(matrix: ArrayList&lt;ArrayList&lt;Float&gt;&gt;, labels: ArrayList&lt;Int&gt;, input: Int) {
        val array = arrayListOf&lt;String&gt;()
        for (vector in matrix) {
            array.add(vector.joinToString(&quot;,&quot;))
        }
        val matrixString = array.joinToString(&quot;\n&quot;)
        val labelsString = labels.joinToString(&quot;,&quot;)

        val values = ContentValues()
        values.put(DATA_INPUT, input)
        values.put(DATA_LEVELS, matrixString)
        values.put(DATA_LABELS, labelsString)

        val db = this.writableDatabase
        db.update(DATA_TABLE, values, &quot;$DATA_ID=0&quot;, null)
        db.close()
    }

//    fun clearData() {
//        val values = ContentValues()
//        values.put(DATA_LEVELS, &quot;&quot;)
//        values.put(DATA_LABELS, &quot;&quot;)
//
//        val db = this.writableDatabase
//        db.update(DATA_TABLE, values, &quot;$DATA_ID=0&quot;, null)
//        db.close()
//    }

    companion object{
        private const val DATABASE_NAME = &quot;parking_rssi&quot;
        private const val DATABASE_VERSION = 8

        const val ROUTER_TABLE = &quot;routers&quot;
        const val ROUTER_BSSID = &quot;bssid&quot;
        const val ROUTER_NAME = &quot;name&quot;
        const val ROUTER_ACTIVE = &quot;active&quot;
        const val ROUTER_ROW = &quot;r&quot;
        const val ROUTER_COL = &quot;c&quot;

        const val DATA_TABLE = &quot;data&quot;
        const val DATA_ID = &quot;id&quot;
        const val DATA_INPUT = &quot;input&quot;
        const val DATA_LEVELS = &quot;levels&quot;
        const val DATA_LABELS = &quot;label&quot;
    }

    class Data (
        val matrix: ArrayList&lt;ArrayList&lt;Float&gt;&gt;,
        val labels: ArrayList&lt;Int&gt;,
        val input: Int
        ) {}
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="knn-classifier"><a class="header" href="#knn-classifier">KNN Classifier</a></h1>
<ul>
<li>Contains the logic implementing the <a href="https://bit.ly/2OcMqHv">K-Nearest Neighbor Algorithm</a>.</li>
</ul>
<h1 id="code-analysis-2"><a class="header" href="#code-analysis-2">Code Analysis</a></h1>
<pre><code class="language-kt">class KNNClassifier(var k: Int = 3) { //k is the literal property for KNN
    var inputSize: Int = 6 //depende kung ilang yung number of routers
    val matrix = arrayListOf&lt;ArrayList&lt;Float&gt;&gt;() //values ng RSSI, 2D matrix siya
    val labels = arrayListOf&lt;Int&gt;()

    fun addPoint(point: ArrayList&lt;Float&gt;, label: Int) { //training part
        if (point.size != inputSize) {
            return
        }

        matrix.add(point)
        labels.add(label)
    }

    // Euclidean Distance
    //E(v1-v2)^2
    private fun calculateDistance(ps1: ArrayList&lt;Float&gt;, ps2: ArrayList&lt;Float&gt;): Float { //evaluation part
        if (ps1.size != ps2.size) return -1f //kuhanin lahat ng distances dito ng bagong point.

        var distance = 0f
        for (i in 0 until ps1.size) {
            distance += (ps1[i] - ps2[i]).pow(2)
        }
        return distance
    }

    fun predict(point: ArrayList&lt;Float&gt;): Int {
        val distances = arrayListOf&lt;Pair&lt;Float, Int&gt;&gt;()
        var distance = 0f
        for (i in 0 until matrix.size) {
            distance = calculateDistance(point, matrix[i])
            distances.add(Pair(distance, labels[i]))
        }
        Log.i(&quot;KNN&quot;, distances.toString())

        distances.sortWith(compareBy { it.first })
        val hashmap = hashMapOf&lt;Int, Int&gt;()
        val min = k.coerceAtMost(matrix.size)
        for (i in 0 until min) {
            hashmap[i] = hashmap.getOrDefault(i, 0) + 1
        }
        Log.i(&quot;KNN&quot;, hashmap.toString())

        var max = -1 // tie breaking, randomized
        val outputs = arrayListOf&lt;Int&gt;()
        for ((key, value) in hashmap) {
            if (value &gt; max) {
                max = value
                outputs.clear()
                outputs.add(key)
            } else if (value == max) {
                outputs.add(key)
            }
        }
        Log.i(&quot;KNN&quot;, outputs.toString())

        val output = if (outputs.size &gt; 1) {
            distances[0].second
        } else {
            outputs[0]
        }

        return output
    }

    fun loadMatrix(context: Context) { //q
        val db = DBHelper(context, null)
        val data = db.getData()
        db.close()

        inputSize = data.input

        matrix.clear()
        matrix.addAll(data.matrix)

        labels.clear()
        labels.addAll(data.labels)

        Log.i(&quot;KNN&quot;, matrix.toString())
        Log.i(&quot;KNN&quot;, labels.toString())
    } //querry sa database

    fun saveMatrix(context: Context) {
        val db = DBHelper(context, null)
        db.setData(matrix, labels, inputSize)
        db.close()
    } //querry sa database
}
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        <script type="text/javascript">
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>
    </body>
</html>
